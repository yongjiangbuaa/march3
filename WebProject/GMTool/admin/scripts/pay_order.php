<?php
define('IN_ADMIN',true);
define('APP_ROOT', realpath(dirname(__DIR__) . '/../gameengine/test'));
define('ADMIN_ROOT', realpath(dirname(__DIR__) . '/'));
ini_set('mbstring.internal_encoding','UTF-8');
include ADMIN_ROOT.'/config.inc.php';
include ADMIN_ROOT.'/admins.php';
include_once ADMIN_ROOT.'/servers.php';
$page = new BasePage();
date_default_timezone_set('UTC');

global $servers;
$eventAll = array();

$time_start = mktime(0,0,0,12,1,2014) * 1000;
$time_end = mktime(24,0,0,12,31,2014) * 1000;

$order_id_list = array(
// "'12999763169054705758.1361944198049567'",
// "'12999763169054705758.1342444126049947'",
// "'12999763169054705758.1346203510540076'",
// "'12999763169054705758.1305733673383107'",
// "'12999763169054705758.1379947326943152'",
// "'12999763169054705758.1382765179736351'",
// "'12999763169054705758.1334443622906996'",
// "'12999763169054705758.1343118577336491'",
// "'12999763169054705758.1388645133852260'",
// "'12999763169054705758.1302273383091286'",
// "'12999763169054705758.1344627918666843'",
// "'12999763169054705758.1358853755537102'",
// "'12999763169054705758.1355344228368712'",
// "'12999763169054705758.1336872782210144'",
// "'12999763169054705758.1315543478521944'",
// "'12999763169054705758.1322532248653528'",
// "'12999763169054705758.1388463997147751'",
// "'12999763169054705758.1318402382125562'",
// "'12999763169054705758.1398285437507011'",
// "'12999763169054705758.1374775000476460'",
// "'12999763169054705758.1325924238595586'",
// "'12999763169054705758.1332862275605354'",
// "'12999763169054705758.1392075969537105'",
// "'12999763169054705758.1310941915586384'",
// "'12999763169054705758.1334661779046402'",
// "'12999763169054705758.1393179416101907'",
// "'12999763169054705758.1308052424639162'",
// "'12999763169054705758.1364743680582228'",
// "'12999763169054705758.1368229418497206'",
// "'12999763169054705758.1362058396329966'",
// "'12999763169054705758.1385917977659115'",
// "'12999763169054705758.1359187873931548'",
// "'12999763169054705758.1393925034568558'",
// "'12999763169054705758.1369459831218366'",
// "'12999763169054705758.1397488497993221'",
// "'12999763169054705758.1301814333843518'",
// "'12999763169054705758.1369142730421322'",
// "'12999763169054705758.1356276853731935'",
// "'12999763169054705758.1346531858563450'",
// "'12999763169054705758.1338574464307150'",
// "'12999763169054705758.1367684167219439'",
// "'12999763169054705758.1381617579510424'",
// "'12999763169054705758.1362482602593485'",
// "'12999763169054705758.1345618641796787'",
// "'12999763169054705758.1371461541006084'",
// "'12999763169054705758.1329073954047432'",
// "'12999763169054705758.1352475171138085'",
// "'12999763169054705758.1301336649005661'",
// "'12999763169054705758.1382251315587852'",
// "'12999763169054705758.1314703511284276'",
// "'12999763169054705758.1398577971067833'",
// "'12999763169054705758.1318229911352643'",
// "'12999763169054705758.1309285599536763'",
// "'12999763169054705758.1361923262023723'",
// "'12999763169054705758.1351128051493907'",
// "'12999763169054705758.1320155177443720'",
// "'12999763169054705758.1361036962390128'",
// "'12999763169054705758.1368663611236731'",
// "'12999763169054705758.1364662455348398'",
// "'12999763169054705758.1301527423612958'",
// "'12999763169054705758.1330047972156548'",
// "'12999763169054705758.1389281020242072'",
// "'12999763169054705758.1363734654342931'",
// "'12999763169054705758.1353480921766966'",
// "'12999763169054705758.1315711905426100'",
// "'12999763169054705758.1398306906415153'",
// "'12999763169054705758.1354630582701664'",
// "'12999763169054705758.1303342218777779'",
// "'12999763169054705758.1348492811983550'",
		"'12999763169054705758.1349635248601562'",
		"'12999763169054705758.1359361683243223'",
		"'12999763169054705758.1388894278829618'",
		"'12999763169054705758.1393819225274797'",
		"'12999763169054705758.1394839221905615'",
		"'12999763169054705758.1339239329735802'",
		"'12999763169054705758.1309777450946600'",
		"'12999763169054705758.1325803534066005'",
		"'12999763169054705758.1389575212170156'",
		"'12999763169054705758.1352513531641579'",
		"'12999763169054705758.1361436565915159'",
		"'12999763169054705758.1370608316831210'",
		"'12999763169054705758.1382145268675055'",
		"'12999763169054705758.1304234193171310'",
		"'12999763169054705758.1377532665932763'",
		"'12999763169054705758.1317021278931519'",
		"'12999763169054705758.1354709996791701'",
		"'12999763169054705758.1343665541304054'",
		"'12999763169054705758.1388047814414528'",
		"'12999763169054705758.1326169909597406'",
		"'12999763169054705758.1335192680188625'",
		"'12999763169054705758.1316912403428644'",
		"'12999763169054705758.1398799865290982'",
		"'12999763169054705758.1303191954806031'",
		"'12999763169054705758.1305711928435920'",
		"'12999763169054705758.1309037328661254'",
		"'12999763169054705758.1331970275347946'",
		"'12999763169054705758.1332837707098138'",
		"'12999763169054705758.1310807310392994'",
		"'12999763169054705758.1313022736820004'",
		"'12999763169054705758.1308226877649133'",
		"'12999763169054705758.1357760797696964'",
		"'12999763169054705758.1350895523533559'",
		"'12999763169054705758.1383993553751651'",
		"'12999763169054705758.1397221543443074'",
		"'12999763169054705758.1360422363352376'",
		"'12999763169054705758.1392725891771672'",
		"'12999763169054705758.1392830037168892'",
		"'12999763169054705758.1342836216197615'",
		"'12999763169054705758.1306251668175622'",
		"'12999763169054705758.1392834405504521'",
		"'12999763169054705758.1345454536595374'",
		"'12999763169054705758.1312025677470392'",
		"'12999763169054705758.1371853967904056'",
		"'12999763169054705758.1329530358407001'",
		"'12999763169054705758.1395116091559103'",
		"'12999763169054705758.1333352121686529'",
		"'12999763169054705758.1395710309029192'",
		"'12999763169054705758.1320503517205326'",
		"'12999763169054705758.1322588279560095'",
		"'12999763169054705758.1344740658769958'",
		"'12999763169054705758.1350337352784611'",
		"'12999763169054705758.1352149765792272'",
		"'12999763169054705758.1368959935891322'",
		"'12999763169054705758.1395553131670990'",
		"'12999763169054705758.1310284377858830'",
		"'12999763169054705758.1322600791095891'",
		"'12999763169054705758.1336765774302841'",
		"'12999763169054705758.1338478004058286'",
		"'12999763169054705758.1349127198051582'",
		"'12999763169054705758.1353193223422355'",
		"'12999763169054705758.1377414195908815'",
		"'12999763169054705758.1389834408778444'",
		"'12999763169054705758.1303921277765938'",
		"'12999763169054705758.1370599440953498'",
		"'12999763169054705758.1322415763539034'",
		"'12999763169054705758.1391355275373885'",
		"'12999763169054705758.1350979196823750'",
		"'12999763169054705758.1369875485130381'",
		"'12999763169054705758.1377728468055027'",
		"'12999763169054705758.1396654356609384'",
		"'12999763169054705758.1332505543783739'",
		"'12999763169054705758.1347052018205892'",
		"'12999763169054705758.1375496351673739'",
		"'12999763169054705758.1348600871886445'",
		"'12999763169054705758.1304700413438287'",
		"'12999763169054705758.1350900991373495'",
		"'12999763169054705758.1391005320314342'",
		"'12999763169054705758.1324730559815846'",
		"'12999763169054705758.1331248713909511'",
		"'12999763169054705758.1316444867727877'",
		"'12999763169054705758.1332878482809496'",
		"'12999763169054705758.1341642711551689'",
		"'12999763169054705758.1361839880836592'",
		"'12999763169054705758.1311471438690066'",
		"'12999763169054705758.1318459835112832'",
		"'12999763169054705758.1318945106185314'",
		"'12999763169054705758.1345981084833306'",
		"'12999763169054705758.1394085120703681'",
		"'12999763169054705758.1379779289640934'",
		"'12999763169054705758.1363136456080567'",
		"'12999763169054705758.1383436410290253'",
		"'12999763169054705758.1312413648739590'",
		"'12999763169054705758.1374841405573895'",
		"'12999763169054705758.1301492764120520'",
		"'12999763169054705758.1365401258779631'",
		"'12999763169054705758.1306238129207306'",
		"'12999763169054705758.1318980068026310'",
		"'12999763169054705758.1396016652913055'",
		"'12999763169054705758.1384605952900834'",
		"'12999763169054705758.1355575565787019'",
		"'12999763169054705758.1340643298778134'",
		"'12999763169054705758.1312368417118879'",
		"'12999763169054705758.1329197628272101'",
		"'12999763169054705758.1367086830570521'",
		"'12999763169054705758.1306119877799694'",
		"'12999763169054705758.1357454130100888'",
		"'12999763169054705758.1361561850857110'",
		"'12999763169054705758.1384855216825082'",
		"'12999763169054705758.1360752187476733'",
		"'12999763169054705758.1346548819018732'",
		"'12999763169054705758.1308811438893785'",
		"'12999763169054705758.1368361911864476'",
		"'12999763169054705758.1311667148121613'",
		"'12999763169054705758.1306838458037365'",
		"'12999763169054705758.1324206959482981'",
		"'12999763169054705758.1303323650681182'",
		"'12999763169054705758.1370040449942355'",
		"'12999763169054705758.1359981227697050'",
		"'12999763169054705758.1337646920916812'",
		"'12999763169054705758.1363182614072626'",
		"'12999763169054705758.1330954594830443'",
		"'12999763169054705758.1322132823945431'",
		"'12999763169054705758.1329710017823013'",
		"'12999763169054705758.1322983079174310'",
		"'12999763169054705758.1382159733238114'",
		"'12999763169054705758.1392817497813473'",
		"'12999763169054705758.1383919142219373'",
		"'12999763169054705758.1360403123025375'",
		"'12999763169054705758.1353883453734454'",
		"'12999763169054705758.1351488724591459'",
		"'12999763169054705758.1322967196269069'",
		"'12999763169054705758.1340100667759414'",
		"'12999763169054705758.1378593055348919'",
		"'12999763169054705758.1363231591590801'",
		"'12999763169054705758.1391893789809601'",
		"'12999763169054705758.1345003740239795'",
		"'12999763169054705758.1373052169601104'",
		"'12999763169054705758.1322115712252226'",
		"'12999763169054705758.1375433755219806'",
		"'12999763169054705758.1323625822896048'",
		"'12999763169054705758.1368368606925689'",
		"'12999763169054705758.1319497169018893'",
		"'12999763169054705758.1310082243162943'",
		"'12999763169054705758.1384815591680039'",
		"'12999763169054705758.1321686977444580'",
		"'12999763169054705758.1359301146602200'",
		"'12999763169054705758.1373359437728674'",
		"'12999763169054705758.1393084273860646'",
		"'12999763169054705758.1374267552464931'",
		"'12999763169054705758.1351274679601060'",
		"'12999763169054705758.1312984355268538'",
		"'12999763169054705758.1314827062405533'",
		"'12999763169054705758.1376187548234578'",
		"'12999763169054705758.1307807859549191'",
		"'12999763169054705758.1384531388639545'",
		"'12999763169054705758.1323503592292762'",
		"'12999763169054705758.1340010034949119'",
		"'12999763169054705758.1355255510613858'",
		"'12999763169054705758.1373351955837505'",
		"'12999763169054705758.1385831015008311'",
		"'12999763169054705758.1392743399278565'",
		"'12999763169054705758.1396696807867389'",
		"'12999763169054705758.1315003645786339'",
		"'12999763169054705758.1359038048604150'",
		"'12999763169054705758.1370582481285200'",
		"'12999763169054705758.1313924722083800'",
		"'12999763169054705758.1319457517099306'",
		"'12999763169054705758.1395449444415951'",
		"'12999763169054705758.1397479177171845'",
		"'12999763169054705758.1365918350492594'",
		"'12999763169054705758.1394267061087673'",
		"'12999763169054705758.1387301065959134'",
		"'12999763169054705758.1325923603576640'",
		"'12999763169054705758.1305507318576077'",
		"'12999763169054705758.1328103963550234'",
		"'12999763169054705758.1322779752077193'",
		"'12999763169054705758.1350015026401536'",
		"'12999763169054705758.1356098881695310'",
		"'12999763169054705758.1334225811002456'",
		"'12999763169054705758.1352740964349148'",
		"'12999763169054705758.1318674548106061'",
		"'12999763169054705758.1323642071740249'",
		"'12999763169054705758.1317018148778880'",
		"'12999763169054705758.1369347882245769'",
		"'12999763169054705758.1302983963974543'",
		"'12999763169054705758.1320782544612934'",
		"'12999763169054705758.1336154570167455'",
		"'12999763169054705758.1343082157817082'",
		"'12999763169054705758.1393645220072759'",
		"'12999763169054705758.1319541443247298'",
		"'12999763169054705758.1348632666693487'",
		"'12999763169054705758.1320046426308983'",
		"'12999763169054705758.1337655611029353'",
		"'12999763169054705758.1343819363247791'",
		"'12999763169054705758.1303811114342710'",
		"'12999763169054705758.1373705836044781'",
		"'12999763169054705758.1319169776883373'",
		"'12999763169054705758.1389727077630179'",
		"'12999763169054705758.1390389606980816'",
		"'12999763169054705758.1354822781082867'",
		"'12999763169054705758.1368766901742961'",
		"'12999763169054705758.1348730043462401'",
		"'12999763169054705758.1318296679326172'",
		"'12999763169054705758.1317524024832780'",
		"'12999763169054705758.1318602106024998'",
		"'12999763169054705758.1357817797408181'",
		"'12999763169054705758.1345644449776284'",
		"'12999763169054705758.1343173833404532'",
		"'12999763169054705758.1380653429412768'",
		"'12999763169054705758.1330703352354611'",
		"'12999763169054705758.1337952360829269'",
		"'12999763169054705758.1318830023864842'",
		"'12999763169054705758.1330787043084111'",
		"'12999763169054705758.1385512953875670'",
		"'12999763169054705758.1397341482728422'",
		"'12999763169054705758.1371395139649078'",
		"'12999763169054705758.1355076602272356'",
		"'12999763169054705758.1329043515983556'",
		"'12999763169054705758.1327932336365677'",
		"'12999763169054705758.1349174687542645'",
		"'12999763169054705758.1332863608376623'",
		"'12999763169054705758.1308211540317513'",
		"'12999763169054705758.1353610448792802'",
		"'12999763169054705758.1375381915427608'",
		"'12999763169054705758.1381668814728606'",
		"'12999763169054705758.1376041520490521'",
		"'12999763169054705758.1379404655568743'",
		"'12999763169054705758.1350196868342614'",
		"'12999763169054705758.1377760274633171'",
		"'12999763169054705758.1369361984568416'",
		"'12999763169054705758.1354965360615496'",
		"'12999763169054705758.1336731887237963'",
		"'12999763169054705758.1395686042684267'",
		"'12999763169054705758.1393894952150636'",
		"'12999763169054705758.1321737403062832'",
		"'12999763169054705758.1304039797545523'",
		"'12999763169054705758.1304562538282601'",
		"'12999763169054705758.1385400569718069'",
		"'12999763169054705758.1373972616978092'",
		"'12999763169054705758.1351385958128225'",
		"'12999763169054705758.1320415210007715'",
		"'12999763169054705758.1324247861060080'",
		"'12999763169054705758.1333681597364907'",
);

$orderids = implode(',', $order_id_list);
$sql1 = "SELECT orderId, uid, productId, spend, payLevel FROM paylog WHERE time >= $time_start and time < $time_end and orderid in ($orderids);";
$modlist = array();
foreach ($servers as $server=>$serverInfo){
	if(substr($server, 0 ,1) != 's'){
		continue;
	}
	
	$result = $page->executeServer($server,$sql1,3);
	if (!empty($result['ret']['data'])) {
		foreach ($result['ret']['data'] as $record){
			$modlist[] = implode(',', $record);
		}
	}
}

echo "orderId, uid, productId, spend, payLevel";
echo implode("\n", $modlist);
echo "\n";
